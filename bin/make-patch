#!/bin/bash
# $1: Proto file name
# make-patch CgProto
function makepatch() {
  local Proto="$1"
  cp src/${Proto}.ts src/proto/${Proto}-patched.ts
  #npm run protots; 
  protoc -I src/proto --ts_out=src src/proto/${Proto}.proto
  (cd src; diff -patch ${Proto}.ts proto/${Proto}-patched.ts > proto/${Proto}.patch); 
  #npm run patch-proto
  patch src/${Proto}.ts < src/proto/${Proto}.patch
}
for p in "$@" ; do makepatch "$p"; done